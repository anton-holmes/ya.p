---

theme: gaia
_class: lead
paginate: true
backgrfalseeeColor: #fff
marp: true
backgroundImage: url('https://marp.app/assets/hero-background.jpg')

---

<style>
section {
  font-family: 'Times New Roman', serif !important;
}
</style>

![bg left:30% 90%](https://upload.wikimedia.org/wikipedia/commons/thumb/b/b0/NewTux.svg/120px-NewTux.svg.png)

## Дисциплина
#### Языки программирования

Старший преподаватель кафедры автоматизированных информационных систем органов внутренних дел, к.т.н. 

###### Попов Антон Дмитриевич

:fast_forward: https://gitlab.com/antonholmes
:fast_forward: https://github.com/anton-holmes


---
### <p style="text-align: center;">Лекция 6. Основные компоненты ОС Linux </p>

* Ядро ОС Linux
* Основы работы с ОС Linux
* Процессы
---

**Операционная система** - комплекс взаимосвязанных программ, предназначенных для управления ресурсами компьютера и организации взаимодействия с пользователем. 

**Ядро** (англ. kernel) — центральная часть операционной системы (ОС), обеспечивающая приложениям координированный доступ к ресурсам компьютера, таким как процессорное время, память, внешнее аппаратное обеспечение, внешнее устройство ввода и вывода информации. Также обычно ядро предоставляет сервисы файловой системы и сетевых протоколов. 

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Ядро </p>
<p style="margin: 0; padding: 0;"> Задачи, выполняемые ядром: </p>

* *Диспетчеризация процессов* 
* *Управление памятью*
* *Предоставление файловой системы*
* *Создание и завершение процессов*.
* *Доступ к устройствам*
* *Работа в сети*
* *Предоставление интерфейса прикладного программирования (API) системных вызовов*

---
<h6> В системе Unix несколько параллельных процессов обслуживают разные задачи. Каждый процесс запрашивает системные ресурсы, будь то энергия, память, сетевое подключение, или какие-то другие ресурсы. Ядро - это большой кусок исполняемого кода, отвечающего за обработку всех таких запросов.</h6>

![bg left:30% 100%](https://2.bp.blogspot.com/-610sfL2BvPs/VeAKkY52rmI/AAAAAAAACsw/nE1wU1ZEv60/s640/08dacde0.png)

---

![bg top:65% 65%](http://rus-linux.net/MyLDP/BOOKS/ldd2/0/images/img1.jpg)

---
**Управление процессами**

Ядро отвечает за создание и уничтожение процессов и обеспечение их взаимодействия с внешним миром (ввод и вывод). Взаимодействие между разными процессами (через сигналы, каналы или примитивов межпроцессных взаимодействий) является основой общей функциональности системы и также возложена на ядро. Дополнительно, планировщик, который распределяет время процессора, тоже является частью системы управления процессами. В общих словах, деятельность процессов управления ядра создаёт абстракцию нескольких процессов поверх одного или нескольких процессоров.

 
---

**Управление памятью**

Память компьютера - главный ресурс и способ управления ей особенно важен для производительности системы. Ядро создаёт виртуальное адресное пространство для каждого процесса поверх имеющихся ограниченных ресурсов. Разные части ядра взаимодействуют с подсистемой управления памятью через набор функциональных вызовов, начиная от простой пары malloc/free до много более развитой функциональности.

---

**Файловые системы**

Unix очень сильно связана с концепцией файловой системы; почти всё в Unix может быть обработано как файл. Ядро строит структурированную файловую систему поверх неструктурированного оборудования и полученная файловая абстракция интенсивно используется всей системой. В дополнение Linux поддерживает множество типов файловых систем, то есть различные способы организации данных на физическом носителе. К примеру, диски могут быть отформатированы в стандартной для Linux файловой системе ext3, часто используемой файловой системе FAT или некоторых других.

---
 
**Управление устройствами**

Почти каждая системная операция в конечном счёте связывается с физическим устройством. За исключением процессора, памяти и очень немногих других объектов, каждая операция управления устройством выполняются кодом, специфичным для данного адресуемого устройства. Этот код называется драйвером устройства. Ядро должно иметь встроенный драйвер устройства для каждой периферии, существующей в системе, от жёсткого диска до клавиатуры и ленточного накопителя. Этот аспект функциональности ядра и является нашим основным интересом в этой книги.

---

**Сетевое подключение**

Сетевое подключение должно управляться операционной системой, потому что большинство сетевых операций не зависят от процессов: входящие пакеты - это асинхронные события. Эти пакеты должны быть собраны, распознаны и распределены перед тем, как они будут переданы другому процессу для обработки. Система отвечает за доставку пакетов данных между программой и сетевыми интерфейсами и должна управлять исполнением программ в зависимости от их сетевой активности. Дополнительно в ядро встроены все задачи маршрутизации и разрешение адресов.

---

**Системный вызов** - обращение прикладной программы к ядру операционной системы для выполнения какой-либо операции.

![bg top:70% 70%](https://lawbooks.news/files/uch_group50/uch_pgroup104/uch_uch524/image/image350.jpg)

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Оболочка </p>

Оболочка — это специальная программа, разработанная для чтения набранных пользователем команд и выполнения соответствующих программ в ответ на эти команды. Иногдатакую программу называют командным интерпретатором.

![top:70% 70%](https://pingvinus.ru/files/notes2/change-shell/list-of-shells.png)

---

##### <p style="text-align: center; margin: 0; padding: 0;"> Иерархия каталогов </p>
Основу этой иерархии составляет корневой каталог по имени **/ (слеш)**. Все файлы и каталоги являются дочерними или более отдаленными потомками корневого каталога.

![top:70% 70%](https://dataenginer.ru/wp-content/uploads/2020/07/linux-directory-structure-1.png)

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Каталоги </p>
Каталог — это особый файл, чье содержимое принимает форму таблицы из имен файлов в совокупности с указателями на соответствующие файлы.

Каждый каталог содержит как минимум две записи: **.** (точка), которая представляет собой ссылку на сам каталог, и **..** (точка-точка), которая является ссылкой на его родительский каталог — тот каталог, что расположен над ним в иерархии. Каждый каталог, за исключением корневого, имеет свой родительский каталог. Для корневого каталога запись .. является ссылкой на него самого (таким образом, обозначение **/..** — то же самое, что и **/** ).

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Путевые имена </p>
* Абсолютное путевое имя начинается со слеша и указывает на местоположение файла относительно корневого каталога. Примеры абсолютного путевого имени для файлов: **/home/mtk/.bashrc**, **/usr/include** и **/** (путевое имя корневого каталога).
* Относительное путевое имя указывает местоположение файла относительно рабочего каталога текущего запущенного процесса и отличается от абсолютного путевого имени отсутствием начального слеша. Из каталога usr на файл types.h можно указать, используя относительное путевое имя **include/sys/types.h** , а из каталога avr доступ к файлу .bashrc можно получить с помощью относительного путевого имени **../mtk/.bashrc** .

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Пользователи </p>

У каждого пользователя имеется уникальное имя для входа в систему (имя пользователя) и соответствующий числовой идентификатор пользователя — numeric user ID (UID). Каждому пользователю соответствует своя строка в файле паролей системы, /etc/passwd, где прописаны все сведения о нем.
* Идентификатор группы (Group ID, GID) — числовой идентификатор группы, к которой принадлежит пользователь.
* Домашний каталог — исходный каталог, в который пользователь попадает после входа в систему.
* Оболочка входа в систему — имя программы, выполняемой для интерпретации команд пользователя.

---

##### <p style="text-align: center; margin: 0; padding: 0;"> Группы, привилегии </p>
В целях администрирования, в частности для управления доступом к файлам и другим системным ресурсам, есть смысл собрать пользователей в группы. Например, всех специа­листов в команде, работающей над одним проектом и пользующейся по этой причине одним и тем же набором файлов, можно свести в одну группу. 

Один из пользователей, называемый привилегированным (superuser), имеет в системе особые привилегии. У учетной записи привилегированного пользователя UID содержит значение 0 , и, как правило, в качестве имени пользователя применяется слово root.

---

Каждая группа обозначается одной строкой в системном файле групп, /etc/group, включающем следующую информацию:

* Название группы — уникальное имя группы.
* Идентификатор группы (Group ID, GID) — числовой идентификатор, связанный с данной группой.
* Список пользователей — список с запятыми в качестве разделителей, содержащий имена пользователей, входящих в группу (которые не идентифицированы как участники группы в поле идентификатора группы в своей записи в файле паролей).

---

##### <p style="text-align: center; margin: 0; padding: 0;"> Владение файлами и права доступа </p>
С каждым файлом связаны UID и GID, определяющие владельца этого файла и группу, к которой он принадлежит. Понятие «владение файлом» применяется для определения прав доступа пользователей к файлу. Для организации доступа к файлу система делит пользователей на три категории: 
* на владельца файла (иногда называемого пользователем файла), 
* пользователей, входящихв группу, соответствующую идентификатору группы (группу) файла, 
* всех остальных (других пользователей). 

---

Для каждой из этих категорий пользователей могут быть установлены три бита прав доступа (что всего составляет девять бит прав доступа):

* права доступа на чтение позволяют считывать содержимое файла;
* права доступа на запись дают возможность вносить изменения в содержимое
файла;
* права доступа на выполнение позволяют выполнять файл, который является либо программой, либо сценарием, обрабатываемым каким-нибудь интерпретатором (обычно,но не всегда им оказывается одна из оболочек).

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Процессы </p>

**Процесс** представляет собой экземпляр выполняемой программы.
Когда программа выполняется, ядро загружает ее код в виртуальную память, выделяет память под переменные программы и определяет учетные структуры данных ядра для записи различной информации о процессе (имеются в виду идентификатор процесса, код завершения, пользовательские и групповые идентификаторы).

С точки зрения ядра процессы являются объектами, между которыми ядро должно делить различные ресурсы компьютера.

---

![top:70% 70%](https://losst.ru/wp-content/uploads/2016/05/htop.png)

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Модель памяти процесса </p>

Процесс логически делится на следующие части, известные как сегменты.
* Текст — инструкции программы.
* Данные — статические переменные, используемые программой.
* Динамическая память (куча) — область, из которой программа может динамически выделять дополнительную память.
* Стек — часть памяти, которая может расширяться и сжиматься по мере вызова функций и возвращения из них и которая используется для выделения хранилища под локальные переменные и информацию о взаимосвязанности вызовов функций.

---
Процесс может создать новый процесс с помощью системного вызова **fork()**. Процесс, вызывающий **fork()**, известен как родительский процесс, а новый процесс называется дочерним
процессом. Ядро создает дочерний процесс путем изготовления дубликата родительского процесса.

Дочерний процесс запускается либо для выполнения другого набора функций в том же самом коде, что и у родительского процесса, либо зачастую для использования системного вызова **execve()** с целью загрузки и выполнения совершенно новой программы.

---

Традиционно в системах UNIX привилегированным считается процесс, чей действующий идентификатор пользователя имеет значение 0 (привилегированный пользователь, суперпользователь).

При загрузке системы ядро создает особый процесс, который называется **init**, «родитель всех процессов». Он ведет свое происхождение от программного файла **/sbin/init**. 
Все процессы в системе создаются (используя **fork()** ) либо процессом init, либо одним из его потомков. Процесс init всегда имеет идентификатор процесса 1 и запускается с правами доступа суперпользователя.

---
##### <p style="text-align: center; margin: 0; padding: 0;"> Процессы-демоны </p>
**Демоном** называется процесс специального назначения, создаваемый и управляемый системой точно так же, как и другие процессы, но отличающийся от них следующими
характеристиками.
* Он долгоживущий. Процесс-демон зачастую запускается при загрузке системы и продолжает свое существование до тех пор, пока работа системы не будет завершена.
* Он запускается в фоновом режиме, и у него нет управляющего терминала, с которого он мог бы считывать ввод или на который он мог бы записывать вывод.
---

К примерам процессов-демонов относятся **syslogd**, который записывает сообщения **в системный журнал,** и **httpd**, который обслуживает веб-страницы посредством протокола передачи гипертекста — Hypertext Transfer Protocol (HTTP).

##### <p style="text-align: center; margin: 0; padding: 0;"> Спасибо за внимание </p>
---